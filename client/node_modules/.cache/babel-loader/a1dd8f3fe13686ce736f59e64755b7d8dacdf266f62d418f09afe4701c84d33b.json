{"ast":null,"code":"var _jsxFileName = \"/workspace/client/src/components/map/CampusMap.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport axios from 'axios';\nimport { motion } from 'framer-motion';\nimport { MapPinIcon, ClockIcon, BuildingOfficeIcon, UserIcon } from '@heroicons/react/24/outline';\n\n// Fix for default markers in React-Leaflet\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png'\n});\n\n// Custom marker icons\nconst createCustomIcon = (color = '#3B82F6') => {\n  return L.divIcon({\n    html: `\n      <div style=\"\n        background-color: ${color};\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n        border: 3px solid white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      \">\n        <div style=\"\n          width: 8px;\n          height: 8px;\n          background-color: white;\n          border-radius: 50%;\n        \"></div>\n      </div>\n    `,\n    className: 'custom-marker',\n    iconSize: [20, 20],\n    iconAnchor: [10, 10]\n  });\n};\n\n// Map controller component\nfunction MapController({\n  selectedSchedule,\n  buildings,\n  onBuildingClick\n}) {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    if (buildings.length > 0) {\n      const bounds = L.latLngBounds(buildings.map(b => [b.coordinates.lat, b.coordinates.lng]));\n      map.fitBounds(bounds, {\n        padding: [20, 20]\n      });\n    }\n  }, [buildings, map]);\n  useEffect(() => {\n    if (selectedSchedule) {\n      const scheduleBuildings = selectedSchedule.courses.map(course => buildings.find(b => b.buildingNumber === course.building)).filter(Boolean);\n      if (scheduleBuildings.length > 0) {\n        const bounds = L.latLngBounds(scheduleBuildings.map(b => [b.coordinates.lat, b.coordinates.lng]));\n        map.fitBounds(bounds, {\n          padding: [50, 50]\n        });\n      }\n    }\n  }, [selectedSchedule, buildings, map]);\n  return null;\n}\n_s(MapController, \"tm7v5wxt+lXe+JHmDCjcGD98tIQ=\", false, function () {\n  return [useMap];\n});\n_c = MapController;\nconst CampusMap = () => {\n  _s2();\n  const [buildings, setBuildings] = useState([]);\n  const [selectedSchedule, setSelectedSchedule] = useState(null);\n  const [schedules, setSchedules] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedBuilding, setSelectedBuilding] = useState(null);\n  const [walkingPaths, setWalkingPaths] = useState([]);\n  useEffect(() => {\n    fetchBuildings();\n    fetchSchedules();\n  }, []);\n  const fetchBuildings = async () => {\n    try {\n      const response = await axios.get('/api/courses/buildings/list');\n      setBuildings(response.data.buildings);\n    } catch (error) {\n      console.error('Failed to fetch buildings:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const fetchSchedules = async () => {\n    try {\n      const response = await axios.get('/api/schedules/my-schedules');\n      setSchedules(response.data.schedules);\n    } catch (error) {\n      console.error('Failed to fetch schedules:', error);\n    }\n  };\n  const handleBuildingClick = building => {\n    setSelectedBuilding(building);\n  };\n  const handleScheduleSelect = schedule => {\n    setSelectedSchedule(schedule);\n    generateWalkingPaths(schedule);\n  };\n  const generateWalkingPaths = schedule => {\n    if (!schedule || !buildings.length) return;\n    const paths = [];\n    const dailySchedules = {};\n\n    // Group courses by day\n    schedule.courses.forEach(course => {\n      course.timeSlots.forEach(slot => {\n        if (!dailySchedules[slot.day]) {\n          dailySchedules[slot.day] = [];\n        }\n        dailySchedules[slot.day].push({\n          ...course,\n          startTime: slot.startTime,\n          endTime: slot.endTime\n        });\n      });\n    });\n\n    // Generate paths for each day\n    Object.entries(dailySchedules).forEach(([day, dayCourses]) => {\n      dayCourses.sort((a, b) => a.startTime.localeCompare(b.startTime));\n      for (let i = 0; i < dayCourses.length - 1; i++) {\n        const currentCourse = dayCourses[i];\n        const nextCourse = dayCourses[i + 1];\n        const currentBuilding = buildings.find(b => b.buildingNumber === currentCourse.building);\n        const nextBuilding = buildings.find(b => b.buildingNumber === nextCourse.building);\n        if (currentBuilding && nextBuilding) {\n          paths.push({\n            from: currentBuilding,\n            to: nextBuilding,\n            day,\n            fromTime: currentCourse.endTime,\n            toTime: nextCourse.startTime,\n            fromCourse: currentCourse.courseCode,\n            toCourse: nextCourse.courseCode\n          });\n        }\n      }\n    });\n    setWalkingPaths(paths);\n  };\n  const getPathColor = path => {\n    const timeDiff = getTimeDifference(path.fromTime, path.toTime);\n    if (timeDiff < 15) return '#EF4444'; // Red for tight schedule\n    if (timeDiff < 30) return '#F59E0B'; // Yellow for moderate\n    return '#10B981'; // Green for comfortable\n  };\n  const getTimeDifference = (time1, time2) => {\n    const [h1, m1] = time1.split(':').map(Number);\n    const [h2, m2] = time2.split(':').map(Number);\n    return h2 * 60 + m2 - (h1 * 60 + m1);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-96\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-bold text-gray-900 mb-6\",\n        children: \"KFUPM Campus Map\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-2\",\n          children: \"Select Schedule to Visualize\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: (selectedSchedule === null || selectedSchedule === void 0 ? void 0 : selectedSchedule._id) || '',\n          onChange: e => {\n            const schedule = schedules.find(s => s._id === e.target.value);\n            handleScheduleSelect(schedule);\n          },\n          className: \"input-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Choose a schedule...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, this), schedules.map(schedule => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: schedule._id,\n            children: [schedule.name, \" - \", schedule.totalCredits, \" credits\"]\n          }, schedule._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: /*#__PURE__*/_jsxDEV(MapContainer, {\n          center: [26.3111, 50.2094],\n          zoom: 15,\n          style: {\n            height: '600px',\n            width: '100%'\n          },\n          className: \"rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n            url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n            attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(MapController, {\n            selectedSchedule: selectedSchedule,\n            buildings: buildings,\n            onBuildingClick: handleBuildingClick\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this), buildings.map(building => {\n            const isInSchedule = selectedSchedule === null || selectedSchedule === void 0 ? void 0 : selectedSchedule.courses.some(course => course.building === building.buildingNumber);\n            return /*#__PURE__*/_jsxDEV(Marker, {\n              position: [building.coordinates.lat, building.coordinates.lng],\n              icon: createCustomIcon(isInSchedule ? '#10B981' : '#3B82F6'),\n              eventHandlers: {\n                click: () => handleBuildingClick(building)\n              },\n              children: /*#__PURE__*/_jsxDEV(Popup, {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"p-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"font-semibold text-gray-900\",\n                    children: [\"Building \", building.buildingNumber]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 253,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-gray-600\",\n                    children: building.buildingName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 256,\n                    columnNumber: 23\n                  }, this), building.departments && /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs text-gray-500 mt-1\",\n                    children: building.departments.join(', ')\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 258,\n                    columnNumber: 25\n                  }, this), isInSchedule && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-2 p-2 bg-green-50 rounded\",\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-green-700 font-medium\",\n                      children: \"Classes in this building:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 264,\n                      columnNumber: 27\n                    }, this), selectedSchedule.courses.filter(course => course.building === building.buildingNumber).map(course => /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-green-600\",\n                      children: [course.courseCode, \" - \", course.instructor]\n                    }, course.crn, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 270,\n                      columnNumber: 31\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 263,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 19\n              }, this)\n            }, building.buildingNumber, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 17\n            }, this);\n          }), walkingPaths.map((path, index) => /*#__PURE__*/_jsxDEV(Polyline, {\n            positions: [[path.from.coordinates.lat, path.from.coordinates.lng], [path.to.coordinates.lat, path.to.coordinates.lng]],\n            color: getPathColor(path),\n            weight: 3,\n            opacity: 0.8,\n            children: /*#__PURE__*/_jsxDEV(Popup, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  className: \"font-medium text-gray-900\",\n                  children: \"Walking Path\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600\",\n                  children: [path.from.buildingName, \" \\u2192 \", path.to.buildingName]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500\",\n                  children: [path.fromCourse, \" \\u2192 \", path.toCourse]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500\",\n                  children: [path.day, \": \", path.fromTime, \" - \", path.toTime]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this), selectedSchedule && /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        className: \"mt-6 p-4 bg-blue-50 rounded-lg\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-gray-900 mb-3\",\n          children: [\"Schedule Summary: \", selectedSchedule.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(BuildingOfficeIcon, {\n              className: \"h-4 w-4 mr-2 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Total Credits: \", selectedSchedule.totalCredits]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(ClockIcon, {\n              className: \"h-4 w-4 mr-2 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Walking Time: \", selectedSchedule.totalWalkingTime, \" min\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(UserIcon, {\n              className: \"h-4 w-4 mr-2 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Score: \", selectedSchedule.score.toFixed(1)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 334,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 11\n      }, this), selectedBuilding && /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        className: \"mt-6 card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-gray-900 mb-3\",\n          children: [\"Building \", selectedBuilding.buildingNumber, \" Details\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Name:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 19\n              }, this), \" \", selectedBuilding.buildingName]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Address:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 356,\n                columnNumber: 19\n              }, this), \" \", selectedBuilding.address]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 17\n            }, this), selectedBuilding.departments && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Departments:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 21\n              }, this), \" \", selectedBuilding.departments.join(', ')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: selectedBuilding.facilities && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm font-medium text-gray-700 mb-1\",\n                children: \"Facilities:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 367,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"text-sm text-gray-600\",\n                children: selectedBuilding.facilities.map(facility => /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [\"\\u2022 \", facility]\n                }, facility, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 368,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 189,\n    columnNumber: 5\n  }, this);\n};\n_s2(CampusMap, \"qHbU8LkKU73Vk1yCskeOkDVdpKs=\");\n_c2 = CampusMap;\nexport default CampusMap;\nvar _c, _c2;\n$RefreshReg$(_c, \"MapController\");\n$RefreshReg$(_c2, \"CampusMap\");","map":{"version":3,"names":["React","useState","useEffect","useRef","MapContainer","TileLayer","Marker","Popup","Polyline","useMap","L","axios","motion","MapPinIcon","ClockIcon","BuildingOfficeIcon","UserIcon","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","createCustomIcon","color","divIcon","html","className","iconSize","iconAnchor","MapController","selectedSchedule","buildings","onBuildingClick","_s","map","length","bounds","latLngBounds","b","coordinates","lat","lng","fitBounds","padding","scheduleBuildings","courses","course","find","buildingNumber","building","filter","Boolean","_c","CampusMap","_s2","setBuildings","setSelectedSchedule","schedules","setSchedules","loading","setLoading","selectedBuilding","setSelectedBuilding","walkingPaths","setWalkingPaths","fetchBuildings","fetchSchedules","response","get","data","error","console","handleBuildingClick","handleScheduleSelect","schedule","generateWalkingPaths","paths","dailySchedules","forEach","timeSlots","slot","day","push","startTime","endTime","Object","entries","dayCourses","sort","a","localeCompare","i","currentCourse","nextCourse","currentBuilding","nextBuilding","from","to","fromTime","toTime","fromCourse","courseCode","toCourse","getPathColor","path","timeDiff","getTimeDifference","time1","time2","h1","m1","split","Number","h2","m2","children","fileName","_jsxFileName","lineNumber","columnNumber","value","_id","onChange","e","s","target","name","totalCredits","center","zoom","style","height","width","url","attribution","isInSchedule","some","position","icon","eventHandlers","click","buildingName","departments","join","instructor","crn","index","positions","weight","opacity","div","initial","y","animate","totalWalkingTime","score","toFixed","address","facilities","facility","_c2","$RefreshReg$"],"sources":["/workspace/client/src/components/map/CampusMap.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport axios from 'axios';\nimport { motion } from 'framer-motion';\nimport { \n  MapPinIcon, \n  ClockIcon, \n  BuildingOfficeIcon,\n  UserIcon \n} from '@heroicons/react/24/outline';\n\n// Fix for default markers in React-Leaflet\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n});\n\n// Custom marker icons\nconst createCustomIcon = (color = '#3B82F6') => {\n  return L.divIcon({\n    html: `\n      <div style=\"\n        background-color: ${color};\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n        border: 3px solid white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      \">\n        <div style=\"\n          width: 8px;\n          height: 8px;\n          background-color: white;\n          border-radius: 50%;\n        \"></div>\n      </div>\n    `,\n    className: 'custom-marker',\n    iconSize: [20, 20],\n    iconAnchor: [10, 10]\n  });\n};\n\n// Map controller component\nfunction MapController({ selectedSchedule, buildings, onBuildingClick }) {\n  const map = useMap();\n\n  useEffect(() => {\n    if (buildings.length > 0) {\n      const bounds = L.latLngBounds(buildings.map(b => [b.coordinates.lat, b.coordinates.lng]));\n      map.fitBounds(bounds, { padding: [20, 20] });\n    }\n  }, [buildings, map]);\n\n  useEffect(() => {\n    if (selectedSchedule) {\n      const scheduleBuildings = selectedSchedule.courses.map(course => \n        buildings.find(b => b.buildingNumber === course.building)\n      ).filter(Boolean);\n      \n      if (scheduleBuildings.length > 0) {\n        const bounds = L.latLngBounds(scheduleBuildings.map(b => [b.coordinates.lat, b.coordinates.lng]));\n        map.fitBounds(bounds, { padding: [50, 50] });\n      }\n    }\n  }, [selectedSchedule, buildings, map]);\n\n  return null;\n}\n\nconst CampusMap = () => {\n  const [buildings, setBuildings] = useState([]);\n  const [selectedSchedule, setSelectedSchedule] = useState(null);\n  const [schedules, setSchedules] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedBuilding, setSelectedBuilding] = useState(null);\n  const [walkingPaths, setWalkingPaths] = useState([]);\n\n  useEffect(() => {\n    fetchBuildings();\n    fetchSchedules();\n  }, []);\n\n  const fetchBuildings = async () => {\n    try {\n      const response = await axios.get('/api/courses/buildings/list');\n      setBuildings(response.data.buildings);\n    } catch (error) {\n      console.error('Failed to fetch buildings:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchSchedules = async () => {\n    try {\n      const response = await axios.get('/api/schedules/my-schedules');\n      setSchedules(response.data.schedules);\n    } catch (error) {\n      console.error('Failed to fetch schedules:', error);\n    }\n  };\n\n  const handleBuildingClick = (building) => {\n    setSelectedBuilding(building);\n  };\n\n  const handleScheduleSelect = (schedule) => {\n    setSelectedSchedule(schedule);\n    generateWalkingPaths(schedule);\n  };\n\n  const generateWalkingPaths = (schedule) => {\n    if (!schedule || !buildings.length) return;\n\n    const paths = [];\n    const dailySchedules = {};\n\n    // Group courses by day\n    schedule.courses.forEach(course => {\n      course.timeSlots.forEach(slot => {\n        if (!dailySchedules[slot.day]) {\n          dailySchedules[slot.day] = [];\n        }\n        dailySchedules[slot.day].push({\n          ...course,\n          startTime: slot.startTime,\n          endTime: slot.endTime\n        });\n      });\n    });\n\n    // Generate paths for each day\n    Object.entries(dailySchedules).forEach(([day, dayCourses]) => {\n      dayCourses.sort((a, b) => a.startTime.localeCompare(b.startTime));\n      \n      for (let i = 0; i < dayCourses.length - 1; i++) {\n        const currentCourse = dayCourses[i];\n        const nextCourse = dayCourses[i + 1];\n        \n        const currentBuilding = buildings.find(b => b.buildingNumber === currentCourse.building);\n        const nextBuilding = buildings.find(b => b.buildingNumber === nextCourse.building);\n        \n        if (currentBuilding && nextBuilding) {\n          paths.push({\n            from: currentBuilding,\n            to: nextBuilding,\n            day,\n            fromTime: currentCourse.endTime,\n            toTime: nextCourse.startTime,\n            fromCourse: currentCourse.courseCode,\n            toCourse: nextCourse.courseCode\n          });\n        }\n      }\n    });\n\n    setWalkingPaths(paths);\n  };\n\n  const getPathColor = (path) => {\n    const timeDiff = getTimeDifference(path.fromTime, path.toTime);\n    if (timeDiff < 15) return '#EF4444'; // Red for tight schedule\n    if (timeDiff < 30) return '#F59E0B'; // Yellow for moderate\n    return '#10B981'; // Green for comfortable\n  };\n\n  const getTimeDifference = (time1, time2) => {\n    const [h1, m1] = time1.split(':').map(Number);\n    const [h2, m2] = time2.split(':').map(Number);\n    return (h2 * 60 + m2) - (h1 * 60 + m1);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-96\">\n        <div className=\"spinner\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"card\">\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-6\">\n          KFUPM Campus Map\n        </h1>\n        \n        {/* Schedule Selector */}\n        <div className=\"mb-6\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Select Schedule to Visualize\n          </label>\n          <select\n            value={selectedSchedule?._id || ''}\n            onChange={(e) => {\n              const schedule = schedules.find(s => s._id === e.target.value);\n              handleScheduleSelect(schedule);\n            }}\n            className=\"input-field\"\n          >\n            <option value=\"\">Choose a schedule...</option>\n            {schedules.map(schedule => (\n              <option key={schedule._id} value={schedule._id}>\n                {schedule.name} - {schedule.totalCredits} credits\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Map Container */}\n        <div className=\"relative\">\n          <MapContainer\n            center={[26.3111, 50.2094]}\n            zoom={15}\n            style={{ height: '600px', width: '100%' }}\n            className=\"rounded-lg\"\n          >\n            <TileLayer\n              url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n              attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n            />\n            \n            <MapController \n              selectedSchedule={selectedSchedule}\n              buildings={buildings}\n              onBuildingClick={handleBuildingClick}\n            />\n\n            {/* Building Markers */}\n            {buildings.map(building => {\n              const isInSchedule = selectedSchedule?.courses.some(\n                course => course.building === building.buildingNumber\n              );\n              \n              return (\n                <Marker\n                  key={building.buildingNumber}\n                  position={[building.coordinates.lat, building.coordinates.lng]}\n                  icon={createCustomIcon(isInSchedule ? '#10B981' : '#3B82F6')}\n                  eventHandlers={{\n                    click: () => handleBuildingClick(building)\n                  }}\n                >\n                  <Popup>\n                    <div className=\"p-2\">\n                      <h3 className=\"font-semibold text-gray-900\">\n                        Building {building.buildingNumber}\n                      </h3>\n                      <p className=\"text-sm text-gray-600\">{building.buildingName}</p>\n                      {building.departments && (\n                        <p className=\"text-xs text-gray-500 mt-1\">\n                          {building.departments.join(', ')}\n                        </p>\n                      )}\n                      {isInSchedule && (\n                        <div className=\"mt-2 p-2 bg-green-50 rounded\">\n                          <p className=\"text-xs text-green-700 font-medium\">\n                            Classes in this building:\n                          </p>\n                          {selectedSchedule.courses\n                            .filter(course => course.building === building.buildingNumber)\n                            .map(course => (\n                              <p key={course.crn} className=\"text-xs text-green-600\">\n                                {course.courseCode} - {course.instructor}\n                              </p>\n                            ))}\n                        </div>\n                      )}\n                    </div>\n                  </Popup>\n                </Marker>\n              );\n            })}\n\n            {/* Walking Paths */}\n            {walkingPaths.map((path, index) => (\n              <Polyline\n                key={index}\n                positions={[\n                  [path.from.coordinates.lat, path.from.coordinates.lng],\n                  [path.to.coordinates.lat, path.to.coordinates.lng]\n                ]}\n                color={getPathColor(path)}\n                weight={3}\n                opacity={0.8}\n              >\n                <Popup>\n                  <div className=\"p-2\">\n                    <h4 className=\"font-medium text-gray-900\">Walking Path</h4>\n                    <p className=\"text-sm text-gray-600\">\n                      {path.from.buildingName} → {path.to.buildingName}\n                    </p>\n                    <p className=\"text-xs text-gray-500\">\n                      {path.fromCourse} → {path.toCourse}\n                    </p>\n                    <p className=\"text-xs text-gray-500\">\n                      {path.day}: {path.fromTime} - {path.toTime}\n                    </p>\n                  </div>\n                </Popup>\n              </Polyline>\n            ))}\n          </MapContainer>\n        </div>\n\n        {/* Schedule Summary */}\n        {selectedSchedule && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"mt-6 p-4 bg-blue-50 rounded-lg\"\n          >\n            <h3 className=\"font-semibold text-gray-900 mb-3\">\n              Schedule Summary: {selectedSchedule.name}\n            </h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n              <div className=\"flex items-center\">\n                <BuildingOfficeIcon className=\"h-4 w-4 mr-2 text-blue-600\" />\n                <span>Total Credits: {selectedSchedule.totalCredits}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <ClockIcon className=\"h-4 w-4 mr-2 text-blue-600\" />\n                <span>Walking Time: {selectedSchedule.totalWalkingTime} min</span>\n              </div>\n              <div className=\"flex items-center\">\n                <UserIcon className=\"h-4 w-4 mr-2 text-blue-600\" />\n                <span>Score: {selectedSchedule.score.toFixed(1)}</span>\n              </div>\n            </div>\n          </motion.div>\n        )}\n\n        {/* Building Details */}\n        {selectedBuilding && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"mt-6 card\"\n          >\n            <h3 className=\"font-semibold text-gray-900 mb-3\">\n              Building {selectedBuilding.buildingNumber} Details\n            </h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <p className=\"text-sm text-gray-600\">\n                  <strong>Name:</strong> {selectedBuilding.buildingName}\n                </p>\n                <p className=\"text-sm text-gray-600\">\n                  <strong>Address:</strong> {selectedBuilding.address}\n                </p>\n                {selectedBuilding.departments && (\n                  <p className=\"text-sm text-gray-600\">\n                    <strong>Departments:</strong> {selectedBuilding.departments.join(', ')}\n                  </p>\n                )}\n              </div>\n              <div>\n                {selectedBuilding.facilities && (\n                  <div>\n                    <p className=\"text-sm font-medium text-gray-700 mb-1\">Facilities:</p>\n                    <ul className=\"text-sm text-gray-600\">\n                      {selectedBuilding.facilities.map(facility => (\n                        <li key={facility}>• {facility}</li>\n                      ))}\n                    </ul>\n                  </div>\n                )}\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CampusMap;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}